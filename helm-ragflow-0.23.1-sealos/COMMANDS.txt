# Diagnose and Fix Commands
# Execute these commands one by one in your Kubernetes plugin terminal

# Step 1: Check current ConfigMap
kubectl get configmap web-visitor-nginx-config -o yaml

# Step 2: Check Pod status
kubectl get pods -l app=web-visitor

# Step 3: Apply new ConfigMap
kubectl apply -f web-visitor-configmap.yaml

# Step 4: Restart web-visitor Pod
kubectl rollout restart deployment/web-visitor

# Step 5: Wait for rollout to complete
kubectl rollout status deployment/web-visitor

# Step 6: Get Pod name
kubectl get pod -l app=web-visitor -o jsonpath='{.items[0].metadata.name}'

# Step 7: Verify nginx config in Pod (replace POD_NAME with actual pod name from step 6)
kubectl exec -it POD_NAME -- cat /etc/nginx/conf.d/default.conf

# Step 8: Test nginx config (replace POD_NAME with actual pod name from step 6)
kubectl exec -it POD_NAME -- nginx -t

# After completing all steps, visit:
# https://sbtlphdeilvf.sealosbja.site/
# https://ragflow.sbtlphdeilvf.sealosbja.site/
